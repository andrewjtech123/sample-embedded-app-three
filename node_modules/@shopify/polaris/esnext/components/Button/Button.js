import * as React from 'react';
import { classNames, variationName } from '@shopify/react-utilities';
import { withAppProvider } from '../AppProvider';
import { handleMouseUpByBlurring } from '../../utilities/focus';
import UnstyledLink from '../UnstyledLink';
import Icon from '../Icon';
import Spinner from '../Spinner';
import Indicator from '../Indicator';
import * as styles from './Button.scss';
const DEFAULT_SIZE = 'medium';
function Button({ id, url, disabled, loading, children, accessibilityLabel, ariaControls, ariaExpanded, onClick, onFocus, onBlur, external, icon, primary, outline, destructive, disclosure, plain, submit, size = DEFAULT_SIZE, fullWidth, polaris: { intl }, }) {
    const indicator = false;
    const isDisabled = disabled || loading;
    const className = classNames(styles.Button, primary && styles.primary, outline && styles.outline, destructive && styles.destructive, isDisabled && styles.disabled, loading && styles.loading, plain && styles.plain, size && size !== DEFAULT_SIZE && styles[variationName('size', size)], fullWidth && styles.fullWidth, icon && children == null && styles.iconOnly);
    const disclosureIconMarkup = disclosure ? (<IconWrapper>
      <Icon source={loading ? 'placeholder' : 'caretDown'}/>
    </IconWrapper>) : null;
    let iconMarkup;
    if (icon) {
        const iconInner = isIconSource(icon) ? (<Icon source={loading ? 'placeholder' : icon}/>) : (icon);
        iconMarkup = <IconWrapper>{iconInner}</IconWrapper>;
    }
    const childMarkup = children ? <span>{children}</span> : null;
    const spinnerColor = primary || destructive ? 'white' : 'inkLightest';
    const spinnerSVGMarkup = loading ? (<span className={styles.Spinner}>
      <Spinner size="small" color={spinnerColor} accessibilityLabel={intl.translate('Polaris.Button.spinnerAccessibilityLabel')}/>
    </span>) : null;
    const indicatorMarkup = indicator && <Indicator />;
    const content = iconMarkup || disclosureIconMarkup ? (<span className={styles.Content}>
        {spinnerSVGMarkup}
        {iconMarkup}
        {childMarkup}
        {disclosureIconMarkup}
      </span>) : (<span className={styles.Content}>
        {spinnerSVGMarkup}
        {childMarkup}
      </span>);
    const type = submit ? 'submit' : 'button';
    return url ? (<UnstyledLink id={id} url={url} external={external} onClick={onClick} onFocus={onFocus} onBlur={onBlur} onMouseUp={handleMouseUpByBlurring} className={className} disabled={isDisabled} aria-label={accessibilityLabel}>
      {indicatorMarkup}
      {content}
    </UnstyledLink>) : (<button id={id} type={type} onClick={onClick} onFocus={onFocus} onBlur={onBlur} onMouseUp={handleMouseUpByBlurring} className={className} disabled={isDisabled} aria-label={accessibilityLabel} aria-controls={ariaControls} aria-expanded={ariaExpanded} role={loading ? 'alert' : undefined} aria-busy={loading ? true : undefined}>
      {indicatorMarkup}
      {content}
    </button>);
}
export function IconWrapper({ children }) {
    return <span className={styles.Icon}>{children}</span>;
}
function isIconSource(x) {
    return typeof x === 'string' || (typeof x === 'object' && x.body);
}
export default withAppProvider()(Button);
